<figure>
  <img src="./images/teaser.png" alt="Teaser Image">
  <figcaption>Consistency of the point clouds created with the two laser scanners of our field robot for a) Initial rigid mounting calibration, b) our ICP method (rigid transformation), and c) our sliding ICP method.</figcaption>
</figure>


### Overview

This repository contains a sliding ICP approach implemented for the kinematic dual laser scanning system of our ground Unmanned Ground Vehicle (UGV), as described in our previous work ([IEEE Xplore Paper](https://ieeexplore.ieee.org/abstract/document/10302421), [Arxiv Version](https://arxiv.org/pdf/2310.11516)). The robot is designed to generate high-resolution point clouds of various crops such as beans, wheat, soybeans, sugar beets, corn, and potatoes, in agricultural fields.

## Key Features

The U-shape design of the 2×2×2m robot causes the scanner mounting calibration relative to the GNSS/IMU trajectory to change over time when driving in uneven field environments.
To address this problem, the method estimates time-dependent mounting calibration updates by:
1. Creating initial point clouds using rigid mounting calibration of both scanners
2. Application of an sliding window approach to cut point clouds along the vehicles trajectory
3. Registration of point cloud cuts by using an ICP algorithms with a symmetric plane-to-plane objective function and robust point matching
4. Computation of the mounting calibration updates by dividing the estimated ICP transformation to the scanners
5. Robust interpolation of the updates to all laser profiles of the scanners

Finally, the aligned point clouds are generated by integrating the interpolated calibration updates into the direct georeferencing equations for both scanners:

$$
\mathbf x_{i_{[l]}}^{e}(t) = \mathbf T_{b}^{e}(t) \Delta \mathbf T_{s_{[l]}}^b(t) \mathbf T_{s_{[l]}}^b \mathbf x_{i}^{s_{[l]}}(t) 
$$

- $\mathbf{x}_{i_{[l]}}^{e}(t)$: Object point $i$ in the Earth coordinate system at time $t$.

- $\mathbf{T}_{b}^{e}(t)$: Trajectory of the UGV represented as transformation matrix from body reference frame to the Earth reference frame at time \(t\).

- $\Delta \mathbf{T}_{s_{[l]}}^{b}(t)$: Mounting calibration updates for the scanner \(s_{[l]}\) in the body referenec frame over time \(t\).

- $\mathbf{T}_{s_{[l]}}^{b}$: Rigid mounting calibration for the sensor \(s_{[l]}\) in the body reference frame.

- $\mathbf{x}_{i}^{s_{[l]}}(t)$: Object point \(i\) in the sensor \(s_{[l]}\) reference frame at time \(t\).

## Installation (Docker)

The repository also contains Dockerfile. Please build and run the docker using the following commands:
  ```bash
  docker build -t sliding_icp_docker .
  docker run -it --name your_test_run sliding_icp_docker:latest 
  ```
## Data

The wheat, corn and sugar beet dataset is provided via sciebo share: https://uni-bonn.sciebo.de/s/qgLQ8wfS7oMWase. Download the laser profile data (.bin) for both scanners and the trajectory files (.trj) and copy them into /input folder of the repository. Note that only one dataset can be placed in the input folder. 


